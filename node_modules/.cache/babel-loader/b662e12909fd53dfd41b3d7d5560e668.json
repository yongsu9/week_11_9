{"ast":null,"code":"import { getType } from \"typesafe-actions\";\nexport const asyncState = {\n  initial: initialData => ({\n    loading: false,\n    data: initialData || null,\n    error: null\n  }),\n  load: data => ({\n    loading: true,\n    data: data || null,\n    error: null\n  }),\n  success: data => ({\n    data,\n    loading: false,\n    error: null\n  }),\n  error: error => ({\n    error,\n    loading: false,\n    data: null\n  })\n};\nexport function transformToArray(asyncActionCreator) {\n  const {\n    request,\n    success,\n    failure\n  } = asyncActionCreator;\n  return [request, success, failure];\n}\nexport function createAsyncReducer(asyncActionCreator, key) {\n  return (state, action) => {\n    const [request, success, failure] = [asyncActionCreator.request, asyncActionCreator.success, asyncActionCreator.failure].map(getType);\n\n    switch (action.type) {\n      case request:\n        return { ...state,\n          [key]: asyncState.load()\n        };\n\n      case success:\n        return { ...state,\n          [key]: asyncState.success(action.payload)\n        };\n\n      case failure:\n        return { ...state,\n          [key]: asyncState.error(action.payload)\n        };\n\n      default:\n        return state;\n    }\n  };\n}","map":{"version":3,"sources":["C:/Users/yongs/react-tutorial/week_11_9/src/lib/reducerUtils.ts"],"names":["getType","asyncState","initial","initialData","loading","data","error","load","success","transformToArray","asyncActionCreator","request","failure","createAsyncReducer","key","state","action","map","type","payload"],"mappings":"AACA,SAAgDA,OAAhD,QAA+D,kBAA/D;AAQA,OAAO,MAAMC,UAAU,GAAG;AACtBC,EAAAA,OAAO,EAASC,WAAP,KAA8C;AACnDC,IAAAA,OAAO,EAAE,KAD0C;AAEnDC,IAAAA,IAAI,EAAEF,WAAW,IAAI,IAF8B;AAGnDG,IAAAA,KAAK,EAAE;AAH4C,GAA9C,CADa;AAMtBC,EAAAA,IAAI,EAASF,IAAP,KAA8C;AAChDD,IAAAA,OAAO,EAAE,IADuC;AAEhDC,IAAAA,IAAI,EAAEA,IAAI,IAAI,IAFkC;AAGhDC,IAAAA,KAAK,EAAE;AAHyC,GAA9C,CANgB;AAWtBE,EAAAA,OAAO,EAASH,IAAP,KAAsC;AAC3CA,IAAAA,IAD2C;AAE3CD,IAAAA,OAAO,EAAE,KAFkC;AAG3CE,IAAAA,KAAK,EAAE;AAHoC,GAAtC,CAXa;AAgBtBA,EAAAA,KAAK,EAASA,KAAP,KAAuC;AAC1CA,IAAAA,KAD0C;AAE1CF,IAAAA,OAAO,EAAE,KAFiC;AAG1CC,IAAAA,IAAI,EAAE;AAHoC,GAAvC;AAhBe,CAAnB;AAwBP,OAAO,SAASI,gBAAT,CAA4DC,kBAA5D,EAAoF;AACvF,QAAM;AAAEC,IAAAA,OAAF;AAAWH,IAAAA,OAAX;AAAoBI,IAAAA;AAApB,MAAgCF,kBAAtC;AACA,SAAO,CAACC,OAAD,EAAUH,OAAV,EAAmBI,OAAnB,CAAP;AACH;AACD,OAAO,SAASC,kBAAT,CACHH,kBADG,EAEHI,GAFG,EAGL;AACE,SAAO,CAACC,KAAD,EAAWC,MAAX,KAAsC;AACzC,UAAM,CAACL,OAAD,EAAUH,OAAV,EAAmBI,OAAnB,IAA8B,CAChCF,kBAAkB,CAACC,OADa,EAEhCD,kBAAkB,CAACF,OAFa,EAGhCE,kBAAkB,CAACE,OAHa,EAIlCK,GAJkC,CAI9BjB,OAJ8B,CAApC;;AAMA,YAAQgB,MAAM,CAACE,IAAf;AACI,WAAKP,OAAL;AACI,eAAO,EACH,GAAGI,KADA;AAEH,WAACD,GAAD,GAAOb,UAAU,CAACM,IAAX;AAFJ,SAAP;;AAIJ,WAAKC,OAAL;AACI,eAAO,EACH,GAAGO,KADA;AAEH,WAACD,GAAD,GAAOb,UAAU,CAACO,OAAX,CAAmBQ,MAAM,CAACG,OAA1B;AAFJ,SAAP;;AAIJ,WAAKP,OAAL;AACI,eAAO,EACH,GAAGG,KADA;AAEH,WAACD,GAAD,GAAOb,UAAU,CAACK,KAAX,CAAiBU,MAAM,CAACG,OAAxB;AAFJ,SAAP;;AAIJ;AACI,eAAOJ,KAAP;AAjBR;AAmBH,GA1BD;AA2BH","sourcesContent":["import { AnyAction } from \"redux\";\r\nimport { ActionType, AsyncActionCreatorBuilder, getType } from \"typesafe-actions\";\r\n\r\nexport type AsyncState<T, E = any> = {\r\n    loading: boolean;\r\n    data: T | null;\r\n    error: E | null;\r\n};\r\n\r\nexport const asyncState = {\r\n    initial: <T, E>(initialData?: T): AsyncState<T, E> => ({\r\n        loading: false,\r\n        data: initialData || null,\r\n        error: null\r\n    }),\r\n    load: <T, E>(data?: T | null): AsyncState<T, E> => ({\r\n        loading: true,\r\n        data: data || null,\r\n        error: null\r\n    }),\r\n    success: <T, E>(data: T): AsyncState<T, E> => ({\r\n        data,\r\n        loading: false,        \r\n        error: null\r\n    }),\r\n    error: <T, E>(error: E): AsyncState<T, E> => ({\r\n        error,\r\n        loading: false,\r\n        data: null,        \r\n    }),\r\n};\r\n\r\ntype AnyAsyncActionCreator = AsyncActionCreatorBuilder<any,any,any>;\r\nexport function transformToArray<AC extends AnyAsyncActionCreator>(asyncActionCreator: AC) {\r\n    const { request, success, failure } = asyncActionCreator;\r\n    return [request, success, failure];\r\n}\r\nexport function createAsyncReducer<S, AC extends AnyAsyncActionCreator, K extends keyof S>(\r\n    asyncActionCreator: AC, \r\n    key: K\r\n) {\r\n    return (state: S, action: ActionType<AC>) => {\r\n        const [request, success, failure] = [\r\n            asyncActionCreator.request,\r\n            asyncActionCreator.success,\r\n            asyncActionCreator.failure\r\n        ].map(getType);\r\n\r\n        switch (action.type){\r\n            case request:\r\n                return {\r\n                    ...state,\r\n                    [key]: asyncState.load(),\r\n                };\r\n            case success:\r\n                return {\r\n                    ...state,\r\n                    [key]: asyncState.success(action.payload),\r\n                };\r\n            case failure:\r\n                return {\r\n                    ...state,\r\n                    [key]: asyncState.error(action.payload),\r\n                }\r\n            default:\r\n                return state;\r\n        }\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}